# 电商秒杀项目开发日志



## 一、搭建基础SpringBoot项目

### 1.创建Maven项目

创建一个maven项目，将main目录下的java目录指定为source root，新建一个resources目录指定为resources root。

### 2.实现简单SpringBoot WEB项目

1. 查阅官网引入SpringBoot相关依赖。

```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.2.1.RELEASE</version>
</parent>
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
</dependencies>
```

2. 实现简单WEB项目

   App类添加 @EnableAutoConfiguration 注解，该注解的含义是自动加载应用程序所需的所有bean，并且将该类指定为springboot项目的启动类。

   main方法中，添加SpringApplication.run(App.class,args);后，main方法运行就会启动一个SpringBoot的web项目。

### 3.引入MyBatis依赖

包括mysql的依赖、数据库连接池的依赖以及springboot集成mybatis依赖。

```xml
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>5.1.41</version>
</dependency>
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>druid</artifactId>
    <version>1.1.3</version>
</dependency>
<dependency>
    <groupId>org.mybatis.spring.boot</groupId>
    <artifactId>mybatis-spring-boot-starter</artifactId>
    <version>1.3.1</version>
</dependency>
```



### 4.引入MyBatis generator自动生成器

引入MyBatis generator相关依赖

```xml
<plugin>
    <groupId>org.mybatis.generator</groupId>
    <artifactId>mybatis-generator-maven-plugin</artifactId>
    <version>1.3.5</version>
    <dependencies>     
        <dependency>
            <groupId>org.mybatis.generator</groupId>
            <artifactId>mybatis-generator-core</artifactId>
            <version>1.3.5</version>
        </dependency>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.41</version>
        </dependency>
    </dependencies>
    <executions>
        <execution>
            <id>mybatis generator</id>
            <phase>package</phase>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
    <!--以上为基本配置，下面为特殊配置-->
    <configuration>
        <!--允许移动生成文件 -->
        <verbose>true</verbose>
        <!--允许自动覆盖文件，实际开发中不要改为true-->
        <overwrite>true</overwrite>
        <!--mybatis generator文件的路径-->
        <configurationFile>
            src/main/resources/mybatis-generator.xml
        </configurationFile>
    </configuration>
</plugin>
```

注意：一般第一次使用MyBatis自动生成，之后有新的需求通过手动添加。协作开发时不要将overwrite属性设为true，可能会直接覆盖其他人的开发成果。

- 配置mybatis-generator.xml文件。
- Edit configurations新建maven指令，执行mybatis-generator:generate指令。执行成功可以看到新生成的文件。
- 得到自动生成的DO文件，DAO文件和mapper文件。其中DO文件中会包含两个DOExample文件，主要包含一些复杂查询的语句，一般而言企业开发对于复杂查询选择自己开发的方式更多。可以在generator中的配置中增加一些属性来将复杂查询去掉。

### 5.其他配置

- 在application.properties中对数据库和数据源进行配置。这里使用的mysql-connector 版本为8，因此url中需要设置serverTimezone，否则会报错；且数据驱动的driverClassName为com.mysql.cj.jdbc.Driver

  ```
  #使用springboot自带的数据库配置
  spring.datasource.name=seckill
  spring.datasource.url=jdbc:mysql://localhost:3306/db_seckill?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai
  spring.datasource.username=root
  spring.datasource.password=123456
  
  #使用druid数据源
  spring.datasource.type=com.alibaba.druid.pool.DruidDataSource
  spring.datasource.driverClassName=com.mysql.cj.jdbc.Driver
  ```

- App类中修改 @EnableAutoConfiguration注解为，@SpringBootApplication(scanBasePackages = {"com.seckillproject"})。SpringBootApplication启动时会默认扫描当前包及其子包，通过scanBasePackages属性可以指定扫描当前包下的其他包。
- 添加 @MapperScan注解用于自动扫描指定的包中的mapper接口。

配置完毕后，写一段获取数据的代码用于测试项目是否可以正常启动。项目启动正常，则可以开始编写业务代码。

```java
@Autowired
private UserDOMapper userDOMapper;
@RequestMapping("/")
public String home(){
    UserDO userDO=userDOMapper.selectByPrimaryKey(1);
    if(userDO==null){
        return "对象用户不存在";
    }else {
        return userDO.getName();
    }
}
```



## 二、用户模块开发





